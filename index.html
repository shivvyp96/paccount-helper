<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P-Account Builder Helper</title>
<style>
body {
    font-family: "Trebuchet MS", sans-serif;
    background: #40197D;
    color: #e2e8f0;
    margin: 0;
    display: flex;
    height: 100vh;
    overflow: hidden;
}

/* ===== LEFT PANEL ===== */
#left-panel {
    width: 420px;
    background: #2c165b;
    border-right: 2px solid #6b4fd4;
    display: flex;
    flex-direction: column;
}
#left-panel input, #left-panel button { 
    margin: 6px 10px; 
}
#wiki-username {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #6b4fd4;
    background: #2c165b;
    color: #e2e8f0;
    width: calc(100% - 32px);
}
.scroll-container { 
    overflow-y: auto; 
    flex-grow: 1; 
    padding: 10px; 
}

/* ===== HEADINGS ===== */
h2 {
    color: #d0bfff;
    margin: 0;
    padding: 10px 5px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    background: #2c165b;
    position: sticky;
    top: 0;
    border-bottom: 1px solid #6b4fd4;
}
.arrow { transition: transform 0.2s; }

/* ===== LIST ITEMS ===== */
ul { 
    list-style: none; 
    padding-left: 10px; 
    margin: 0 0 15px 0; 
}
li { 
    padding: 5px 0; 
    cursor: pointer; 
}
li:hover { color: #b59bff; }

/* ===== STATUS COLOURS ===== */
li.completed { color: #22c55e; text-decoration: line-through; }
li.incomplete { color: #f87171; }

/* ===== RIGHT PANEL ===== */
#right-panel {
    flex-grow: 1;
    padding: 20px;
    overflow-y: auto;
    background: #3a246d;
    display: flex;
    flex-direction: column;
    border-left: 2px solid #6b4fd4;
}
#right-panel h2 { color: #fff; margin-bottom: 10px; }

/* ===== BUTTONS ===== */
button {
    padding: 8px;
    border-radius: 5px;
    border: none;
    background: #6b4fd4;
    color: #fff;
    cursor: pointer;
    margin: 5px 0;
    transition: all 0.2s ease;
}
button:hover { background: #7e60e3; }
button.secondary { background: #5a3ea6; }

/* ===== STACK ===== */
#stacked-tasks {
    flex-grow: 1;
    overflow-y: auto;
    margin-bottom: 10px;
    border: 1px solid #6b4fd4;
    padding: 10px;
    border-radius: 8px;
    background: #2c165b;
    box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
}
.stacked-task {
    background: #40197D;
    margin-bottom: 5px;
    padding: 8px;
    border-radius: 5px;
    font-family: monospace;
    border-left: 4px solid #6b4fd4;
}

/* ===== SKILLS GRID ===== */
.skills-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    padding: 8px;
    margin-top: 10px;
}
.skill-tile {
    background: #2c165b;
    border: 1px solid #4d2a9b;
    border-radius: 6px;
    padding: 8px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s ease;
    position: relative;
}
.skill-tile:hover { border-color: #b59bff; background: #3a246d; }
.skill-tile img { width: 36px; height: 36px; }
.skill-name { font-size: 12px; margin-top: 4px; color: #e2e8f0; }
.skill-level { font-size: 12px; margin-top: 2px; color: #d0bfff; }
/* ===== TOOLTIP ===== */
.skill-tile .tooltip {
    visibility: hidden;
    background-color: #3a246d;
    color: #fff;
    text-align: center;
    border-radius: 5px;
    padding: 5px;
    position: absolute;
    z-index: 1;
    bottom: 110%;
    left: 50%;
    transform: translateX(-50%);
    white-space: nowrap;
    font-size: 11px;
    border: 1px solid #6b4fd4;
}
.skill-tile:hover .tooltip { visibility: visible; }
</style>
</head>
<body>

<!-- LEFT PANEL -->
<div id="left-panel">
    <input type="text" id="wiki-username" placeholder="RuneLite WikiSync Username">
    <button onclick="importWikiSync()">Import WikiSync</button>
    <div class="scroll-container">
        <!-- ===== QUESTS ===== -->
        <h2 onclick="toggleSection('quests')">Quests <span class="arrow">▶</span></h2>
        <ul id="quests">
            <li id="QUEST:COOKS_ASSISTANT" onclick="addTaskSafe('QUEST:COOKS_ASSISTANT')">Cooks Assistant</li>
<li id="QUEST:DORICS_QUEST" onclick="addTaskSafe('QUEST:DORICS_QUEST')">Doric's Quest</li>
<li id="QUEST:DRUIDIC_RITUAL" onclick="addTaskSafe('QUEST:DRUIDIC_RITUAL')">Druidic Ritual</li>
<li id="QUEST:IMP_CATCHER" onclick="addTaskSafe('QUEST:IMP_CATCHER')">Imp Catcher</li>
<li id="QUEST:DWARF_CANNON" onclick="addTaskSafe('QUEST:DWARF_CANNON')">Dwarf Cannon</li>
<li id="QUEST:NATURAL_HISTORY_QUIZ" onclick="addTaskSafe('QUEST:NATURAL_HISTORY_QUIZ')">Natural History Quiz</li>
<li id="QUEST:ROMEO_AND_JULIET" onclick="addTaskSafe('QUEST:ROMEO_AND_JULIET')">Romeo and Juliet</li>
<li id="QUEST:SEA_SLUG" onclick="addTaskSafe('QUEST:SEA_SLUG')">Sea Slug</li>
<li id="QUEST:SHEEP_SHEARER" onclick="addTaskSafe('QUEST:SHEEP_SHEARER')">Sheep Shearer</li>
<li id="QUEST:THE_FEUD" onclick="addTaskSafe('QUEST:THE_FEUD')">The Feud</li>
<li id="QUEST:WITCHS_HOUSE" onclick="addTaskSafe('QUEST:WITCHS_HOUSE')">Witch's House</li>
<li id="QUEST:WITCHS_POTION" onclick="addTaskSafe('QUEST:WITCHS_POTION')">Witch's Potion</li>
<li id="QUEST:BLACK_KNIGHTS_FORTRESS" onclick="addTaskSafe('QUEST:BLACK_KNIGHTS_FORTRESS')">Black Knights' Fortress</li>
<li id="QUEST:GERTRUDES_CAT" onclick="addTaskSafe('QUEST:GERTRUDES_CAT')">Gertrude's Cat</li>
<li id="QUEST:HORROR_FROM_THE_DEEP" onclick="addTaskSafe('QUEST:HORROR_FROM_THE_DEEP')">Horror from the Deep</li>
<li id="QUEST:ELEMENTAL_WORKSHOP_I" onclick="addTaskSafe('QUEST:ELEMENTAL_WORKSHOP_I')">Elemental Workshop I</li>
<li id="QUEST:DEATH_PLATEAU" onclick="addTaskSafe('QUEST:DEATH_PLATEAU')">Death Plateau</li>
<li id="QUEST:TROLL_STRONGHOLD" onclick="addTaskSafe('QUEST:TROLL_STRONGHOLD')">Troll Stronghold</li>
<li id="QUEST:X_MARKS_THE_SPOT" onclick="addTaskSafe('QUEST:X_MARKS_THE_SPOT')">X Marks the Spot</li>
<li id="QUEST:BARCRAWL" onclick="addTaskSafe('QUEST:BARCRAWL')">Alfred Grimhands Barcrawl</li>
<li id="QUEST:CLIENT_OF_KOUREND" onclick="addTaskSafe('QUEST:CLIENT_OF_KOUREND')">Client of Kourend</li>
<li id="QUEST:THE_RESTLESS_GHOST" onclick="addTaskSafe('QUEST:THE_RESTLESS_GHOST')">The Restless Ghost</li>
<li id="QUEST:RUNE_MYSTERIES" onclick="addTaskSafe('QUEST:RUNE_MYSTERIES')">Rune Mysteries</li>
<li id="QUEST:VAMPYRE_SLAYER" onclick="addTaskSafe('QUEST:VAMPYRE_SLAYER')">Vampyre Slayer</li>
<li id="QUEST:WATERFALL_QUEST" onclick="addTaskSafe('QUEST:WATERFALL_QUEST')">Waterfall Quest</li>
<li id="QUEST:PLAGUE_CITY" onclick="addTaskSafe('QUEST:PLAGUE_CITY')">Plague City</li>
<li id="QUEST:BIOHAZARD" onclick="addTaskSafe('QUEST:BIOHAZARD')">Biohazard</li>
<li id="QUEST:THE_KNIGHTS_SWORD" onclick="addTaskSafe('QUEST:THE_KNIGHTS_SWORD')">The Knight's Sword</li>
<li id="QUEST:ERNEST_THE_CHICKEN" onclick="addTaskSafe('QUEST:ERNEST_THE_CHICKEN')">Ernest the Chicken</li>
<li id="QUEST:MONKS_FRIEND" onclick="addTaskSafe('QUEST:MONKS_FRIEND')">Monk's Friend</li>
<li id="QUEST:FIGHT_ARENA" onclick="addTaskSafe('QUEST:FIGHT_ARENA')">Fight Arena</li>
<li id="QUEST:TREE_GNOME_VILLAGE" onclick="addTaskSafe('QUEST:TREE_GNOME_VILLAGE')">Tree Gnome Village</li>
<li id="QUEST:PRIEST_IN_PERIL" onclick="addTaskSafe('QUEST:PRIEST_IN_PERIL')">Priest in Peril</li>
<li id="QUEST:NATURE_SPIRIT" onclick="addTaskSafe('QUEST:NATURE_SPIRIT')">Nature Spirit</li>
<li id="QUEST:RFD_COOK" onclick="addTaskSafe('QUEST:RFD_COOK')">RFD Cook</li>
<li id="QUEST:RFD_DWARF" onclick="addTaskSafe('QUEST:RFD_DWARF')">RFD Dwarf</li>
<li id="QUEST:FISHING_CONTEST" onclick="addTaskSafe('QUEST:FISHING_CONTEST')">Fishing Contest</li>
<li id="QUEST:A_PORCINE_OF_INTEREST" onclick="addTaskSafe('QUEST:A_PORCINE_OF_INTEREST')">A Porcine of Interest</li>
<li id="QUEST:ANIMAL_MAGNETISM" onclick="addTaskSafe('QUEST:ANIMAL_MAGNETISM')">Animal Magnetism</li>
<li id="QUEST:MERLINS_CRYSTAL" onclick="addTaskSafe('QUEST:MERLINS_CRYSTAL')">Merlins Crystal</li>
<li id="QUEST:HOLY_GRAIL" onclick="addTaskSafe('QUEST:HOLY_GRAIL')">Holy Grail</li>
<li id="QUEST:DRAGON_SLAYER_I" onclick="addTaskSafe('QUEST:DRAGON_SLAYER_I')">Dragon Slayer I</li>
<li id="QUEST:LOST_CITY" onclick="addTaskSafe('QUEST:LOST_CITY')">Lost City</li>
<li id="QUEST:WHAT_LIES_BELOW" onclick="addTaskSafe('QUEST:WHAT_LIES_BELOW')">What Lies Below</li>
<li id="QUEST:THE_DIG_SITE" onclick="addTaskSafe('QUEST:THE_DIG_SITE')">The Dig Site</li>
<li id="QUEST:THE_GRAND_TREE" onclick="addTaskSafe('QUEST:THE_GRAND_TREE')">The Grand Tree</li>
<li id="QUEST:GOBLIN_DIPLOMACY" onclick="addTaskSafe('QUEST:GOBLIN_DIPLOMACY')">Goblin Diplomacy</li>
<li id="QUEST:RFD_GOBLINS" onclick="addTaskSafe('QUEST:RFD_GOBLINS')">RFD Goblins</li>
<li id="QUEST:FAIRYTALE_I" onclick="addTaskSafe('QUEST:FAIRYTALE_I')">Fairy Tale I</li>
<li id="QUEST:BONE_VOYAGE" onclick="addTaskSafe('QUEST:BONE_VOYAGE')">Bone Voyage</li>
<li id="QUEST:JUNGLE_POTION" onclick="addTaskSafe('QUEST:JUNGLE_POTION')">Jungle Potion</li>
<li id="QUEST:THE_ASCENT_OF_ARCEUUS" onclick="addTaskSafe('QUEST:THE_ASCENT_OF_ARCEUUS')">The Ascent of Arceuus</li>
<li id="QUEST:SHILO_VILLAGE" onclick="addTaskSafe('QUEST:SHILO_VILLAGE')">Shilo Village</li>
<li id="QUEST:ONE_SMALL_FAVOUR" onclick="addTaskSafe('QUEST:ONE_SMALL_FAVOUR')">One Small Favour</li>
<li id="QUEST:MURDER_MYSTERY" onclick="addTaskSafe('QUEST:MURDER_MYSTERY')">Murder Mystery</li>
<li id="QUEST:KINGS_RANSOM" onclick="addTaskSafe('QUEST:KINGS_RANSOM')">King's Ransom</li>
<li id="QUEST:THE_TOURIST_TRAP" onclick="addTaskSafe('QUEST:THE_TOURIST_TRAP')">The Tourist Trap</li>
<li id="QUEST:TEMPLE_OF_IKOV" onclick="addTaskSafe('QUEST:TEMPLE_OF_IKOV')">Temple of Ikov</li>
<li id="QUEST:DESERT_TREASURE_I" onclick="addTaskSafe('QUEST:DESERT_TREASURE_I')">Desert Treasure I</li>
<li id="QUEST:THE_FREMENNIK_TRIALS" onclick="addTaskSafe('QUEST:THE_FREMENNIK_TRIALS')">The Fremennik Trials</li>
<li id="QUEST:OBSERVATORY_QUEST" onclick="addTaskSafe('QUEST:OBSERVATORY_QUEST')">Observatory Quest</li>
<li id="QUEST:DEMON_SLAYER" onclick="addTaskSafe('QUEST:DEMON_SLAYER')">Demon Slayer</li>
<li id="QUEST:UNDERGROUND_PASS" onclick="addTaskSafe('QUEST:UNDERGROUND_PASS')">Underground Pass</li>
<li id="QUEST:THE_GOLEM" onclick="addTaskSafe('QUEST:THE_GOLEM')">The Golem</li>
<li id="QUEST:SHADOW_OF_THE_STORM" onclick="addTaskSafe('QUEST:SHADOW_OF_THE_STORM')">Shadow of the Storm</li>
<li id="QUEST:GHOSTS_AHOY" onclick="addTaskSafe('QUEST:GHOSTS_AHOY')">Ghosts Ahoy</li>
<li id="QUEST:MAKING_HISTORY" onclick="addTaskSafe('QUEST:MAKING_HISTORY')">Making History</li>
<li id="QUEST:MOUNTAIN_DAUGHTER" onclick="addTaskSafe('QUEST:MOUNTAIN_DAUGHTER')">Mountain Daughter</li>
<li id="QUEST:HAZEEL_CULT" onclick="addTaskSafe('QUEST:HAZEEL_CULT')">Hazeel Cult</li>
<li id="QUEST:CHILDREN_OF_THE_SUN" onclick="addTaskSafe('QUEST:CHILDREN_OF_THE_SUN')">Children of the Sun</li>
<li id="QUEST:PRINCE_ALI_RESCUE" onclick="addTaskSafe('QUEST:PRINCE_ALI_RESCUE')">Prince Ali Rescue</li>
<li id="QUEST:ICTHLARINS_LITTLE_HELPER" onclick="addTaskSafe('QUEST:ICTHLARINS_LITTLE_HELPER')">Icthlarin's Little Helper</li>
<li id="QUEST:ENTER_THE_ABYSS" onclick="addTaskSafe('QUEST:ENTER_THE_ABYSS')">Enter the Abyss</li>
<li id="QUEST:TEMPLE_OF_THE_EYE" onclick="addTaskSafe('QUEST:TEMPLE_OF_THE_EYE')">Temple of the Eye</li>
<li id="QUEST:CREATURE_OF_FENKENSTRAIN" onclick="addTaskSafe('QUEST:CREATURE_OF_FENKENSTRAIN')">Creature of Fenkenstrain</li>
<li id="QUEST:THE_DEPTHS_OF_DESPAIR" onclick="addTaskSafe('QUEST:THE_DEPTHS_OF_DESPAIR')">The Depths of Despair</li>
<li id="QUEST:THE_QUEEN_OF_THIEVES" onclick="addTaskSafe('QUEST:THE_QUEEN_OF_THIEVES')">The Queen of Thieves</li>
<li id="QUEST:ENLIGHTENED_JOURNEY" onclick="addTaskSafe('QUEST:ENLIGHTENED_JOURNEY')">Enlightened Journey</li>
<li id="QUEST:SHEEP_HERDER" onclick="addTaskSafe('QUEST:SHEEP_HERDER')">Sheep Herder</li>
<li id="QUEST:BIG_CHOMPY_BIRD_HUNTING" onclick="addTaskSafe('QUEST:BIG_CHOMPY_BIRD_HUNTING')">Big Chompy Bird Hunting</li>
<li id="QUEST:RFD_OGRE" onclick="addTaskSafe('QUEST:RFD_OGRE')">RFD Ogre</li>
<li id="QUEST:RFD_EVIL_DAVE" onclick="addTaskSafe('QUEST:RFD_EVIL_DAVE')">RFD Evil Dave</li>
<li id="QUEST:RFD_PIRATE" onclick="addTaskSafe('QUEST:RFD_PIRATE')">RFD Pirate</li>
<li id="QUEST:RFD_GUIDE" onclick="addTaskSafe('QUEST:RFD_GUIDE')">RFD Lumbridge Guide</li>
<li id="QUEST:RFD_MONKEY" onclick="addTaskSafe('QUEST:RFD_MONKEY')">RFD Monkey</li>
<li id="QUEST:RFD_AMIK_VARZE" onclick="addTaskSafe('QUEST:RFD_AMIK_VARZE')">RFD Sir Amik Varze</li>
<li id="QUEST:RFD_CULINAROMANCER" onclick="addTaskSafe('QUEST:RFD_CULINAROMANCER')">RFD Culinaromancer</li>
<li id="QUEST:SHIELD_OF_ARRAV" onclick="addTaskSafe('QUEST:SHIELD_OF_ARRAV')">Shield of Arrav</li>
<li id="QUEST:HEROES_QUEST" onclick="addTaskSafe('QUEST:HEROES_QUEST')">Heroes Quest</li>
<li id="QUEST:TOWER_OF_LIFE" onclick="addTaskSafe('QUEST:TOWER_OF_LIFE')">Tower of Life</li>
<li id="QUEST:CLOCK_TOWER" onclick="addTaskSafe('QUEST:CLOCK_TOWER')">Clock Tower</li>
<li id="QUEST:TRIBAL_TOTEM" onclick="addTaskSafe('QUEST:TRIBAL_TOTEM')">Tribal Totem</li>
<li id="QUEST:WATCHTOWER" onclick="addTaskSafe('QUEST:WATCHTOWER')">Watchtower</li>
<li id="QUEST:GETTING_AHEAD" onclick="addTaskSafe('QUEST:GETTING_AHEAD')">Getting Ahead</li>
<li id="QUEST:PIRATES_TREASURE" onclick="addTaskSafe('QUEST:PIRATES_TREASURE')">Pirate's Treasure</li>
<li id="QUEST:SCORPION_CATCHER" onclick="addTaskSafe('QUEST:SCORPION_CATCHER')">Scorpion Catcher</li>
<li id="QUEST:THE_CORSAIR_CURSE" onclick="addTaskSafe('QUEST:THE_CORSAIR_CURSE')">The Corsair Curse</li>
<li id="QUEST:FAMILY_CREST" onclick="addTaskSafe('QUEST:FAMILY_CREST')">Family Crest</li>
<li id="QUEST:THE_GARDEN_OF_DEATH" onclick="addTaskSafe('QUEST:THE_GARDEN_OF_DEATH')">The Garden of Death</li>
<li id="QUEST:MONKEY_MADNESS_I" onclick="addTaskSafe('QUEST:MONKEY_MADNESS_I')">Monkey Madness I</li>
<li id="QUEST:THE_FORSAKEN_TOWER" onclick="addTaskSafe('QUEST:THE_FORSAKEN_TOWER')">The Forsaken Tower</li>
<li id="QUEST:HAUNTED_MINE" onclick="addTaskSafe('QUEST:HAUNTED_MINE')">Haunted Mine</li>
<li id="QUEST:TALE_OF_THE_RIGHTEOUS" onclick="addTaskSafe('QUEST:TALE_OF_THE_RIGHTEOUS')">Tale of the Righteous</li>
<li id="QUEST:SLEEPING_GIANTS" onclick="addTaskSafe('QUEST:SLEEPING_GIANTS')">Sleeping Giants</li>
<li id="QUEST:TROLL_ROMANCE" onclick="addTaskSafe('QUEST:TROLL_ROMANCE')">Troll Romance</li>
<li id="QUEST:THE_LOST_TRIBE" onclick="addTaskSafe('QUEST:THE_LOST_TRIBE')">The Lost Tribe</li>
<li id="QUEST:RECRUITMENT_DRIVE" onclick="addTaskSafe('QUEST:RECRUITMENT_DRIVE')">Recruitment Drive</li>
<li id="QUEST:A_KINGDOM_DIVIDED" onclick="addTaskSafe('QUEST:A_KINGDOM_DIVIDED')">A Kingdom Divided</li>
<li id="QUEST:DEATH_ON_THE_ISLE" onclick="addTaskSafe('QUEST:DEATH_ON_THE_ISLE')">Death on the Isle</li>
<li id="QUEST:WANTED" onclick="addTaskSafe('QUEST:WANTED')">Wanted!</li>
<li id="QUEST:TWILIGHTS_PROMISE" onclick="addTaskSafe('QUEST:TWILIGHTS_PROMISE')">Twilights Promise</li>
<li id="QUEST:REGICIDE" onclick="addTaskSafe('QUEST:REGICIDE')">Regicide</li>
<li id="QUEST:ROVING_ELVES" onclick="addTaskSafe('QUEST:ROVING_ELVES')">Roving Elves</li>
<li id="QUEST:MOURNINGS_END_PART_I" onclick="addTaskSafe('QUEST:MOURNINGS_END_PART_I')">Mournings End Part I</li>
<li id="QUEST:MOURNINGS_END_PART_II" onclick="addTaskSafe('QUEST:MOURNINGS_END_PART_II')">Mournings End Part II</li>
<li id="QUEST:ETHICALLY_ACQUIRED_ANTIQUITIES" onclick="addTaskSafe('QUEST:ETHICALLY_ACQUIRED_ANTIQUITIES')">Ethically Acquired Antiquities</li>
<li id="QUEST:DADDYS_HOME" onclick="addTaskSafe('QUEST:DADDYS_HOME')">Daddy's Home</li>
<li id="QUEST:LUNAR_DIPLOMACY" onclick="addTaskSafe('QUEST:LUNAR_DIPLOMACY')">Lunar Diplomacy</li>
<li id="QUEST:IN_SEARCH_OF_THE_MYREQUE" onclick="addTaskSafe('QUEST:IN_SEARCH_OF_THE_MYREQUE')">In Search of the Myreque</li>
<li id="QUEST:IN_AID_OF_THE_MYREQUE" onclick="addTaskSafe('QUEST:IN_AID_OF_THE_MYREQUE')">In Aid of the Myreque</li>
<li id="QUEST:THRONE_OF_MISCELLANIA" onclick="addTaskSafe('QUEST:THRONE_OF_MISCELLANIA')">Throne of Miscellania</li>
<li id="QUEST:ROYAL_TROUBLE" onclick="addTaskSafe('QUEST:ROYAL_TROUBLE')">Royal Trouble</li>
<li id="QUEST:THE_HAND_IN_THE_SAND" onclick="addTaskSafe('QUEST:THE_HAND_IN_THE_SAND')">The Hand in the Sand</li>
<li id="QUEST:ZOGRE_FLESH_EATERS" onclick="addTaskSafe('QUEST:ZOGRE_FLESH_EATERS')">Zogre Flesh Eaters</li>
<li id="QUEST:RUM_DEAL" onclick="addTaskSafe('QUEST:RUM_DEAL')">Rum Deal</li>
<li id="QUEST:CABIN_FEVER" onclick="addTaskSafe('QUEST:CABIN_FEVER')">Cabin Fever</li>
<li id="QUEST:THE_EYES_OF_GLOUPHRIE" onclick="addTaskSafe('QUEST:THE_EYES_OF_GLOUPHRIE')">The Eyes of Glouphrie</li>
<li id="QUEST:THE_SLUG_MENACE" onclick="addTaskSafe('QUEST:THE_SLUG_MENACE')">The Slug Menace</li>
<li id="QUEST:BELOW_ICE_MOUNTAIN" onclick="addTaskSafe('QUEST:BELOW_ICE_MOUNTAIN')">Below Ice Mountain</li>
<li id="QUEST:EADGARS_RUSE" onclick="addTaskSafe('QUEST:EADGARS_RUSE')">Eadgars Ruse</li>
<li id="QUEST:GARDEN_OF_TRANQUILLITY" onclick="addTaskSafe('QUEST:GARDEN_OF_TRANQUILLITY')">Garden of Tranquillity</li>
<li id="QUEST:A_SOULS_BANE" onclick="addTaskSafe('QUEST:A_SOULS_BANE')">A Soul's Bane</li>
<li id="QUEST:SHADOWS_OF_CUSTODIA" onclick="addTaskSafe('QUEST:SHADOWS_OF_CUSTODIA')">Shadows of Custodia</li>
<li id="QUEST:MONKEY_MADNESS_II" onclick="addTaskSafe('QUEST:MONKEY_MADNESS_II')">Monkey Madness II</li>
<li id="QUEST:TAI_BWO_WANNAI_TRIO" onclick="addTaskSafe('QUEST:TAI_BWO_WANNAI_TRIO')">Tai Bwo Wannai Trio</li>
<li id="QUEST:BARBARIAN_TRAINING" onclick="addTaskSafe('QUEST:BARBARIAN_TRAINING')">Barbarian Training</li>
<li id="QUEST:THE_FREMENNIK_ISLES" onclick="addTaskSafe('QUEST:THE_FREMENNIK_ISLES')">The Fremennik Isles</li>
<li id="QUEST:PANDEMONIUM" onclick="addTaskSafe('QUEST:PANDEMONIUM')">Pandemonium</li>
<li id="QUEST:PRYING_TIMES" onclick="addTaskSafe('QUEST:PRYING_TIMES')">Prying Times</li>
<li id="QUEST:CURRENT_AFFAIRS" onclick="addTaskSafe('QUEST:CURRENT_AFFAIRS')">Current Affairs</li>
<li id="QUEST:MA1" onclick="addTaskSafe('QUEST:MA1')">Mage Arena I</li>
<li id="QUEST:MA2" onclick="addTaskSafe('QUEST:MA2')">Mage Arena II</li>
        </ul>
        <!-- ===== SKILLS ===== -->
        <h2 onclick="toggleSection('skills')">Skills <span class="arrow">▶</span></h2>
        <div id="skills" style="display: none;">
            <div class="skills-grid" id="skills-grid"></div>
        </div>
        <!-- ===== ACHIEVEMENT DIARIES ===== -->
        <h2 onclick="toggleSection('diaries')">Achievement Diaries <span class="arrow">▶</span></h2>
        <ul id="diaries">
            <li id="DIARY:VARROCK_EASY" onclick="addTaskSafe('DIARY:VARROCK_EASY')">Varrock Easy</li>
<li id="DIARY:VARROCK_MEDIUM" onclick="addTaskSafe('DIARY:VARROCK_MEDIUM')">Varrock Medium</li>
<li id="DIARY:ARDOUGNE_EASY" onclick="addTaskSafe('DIARY:ARDOUGNE_EASY')">Ardougne Easy</li>
<li id="DIARY:ARDOUGNE_MEDIUM" onclick="addTaskSafe('DIARY:ARDOUGNE_MEDIUM')">Ardougne Medium</li>
<li id="DIARY:LUMBRIDGE_EASY" onclick="addTaskSafe('DIARY:LUMBRIDGE_EASY')">Lumbridge Easy</li>
<li id="DIARY:LUMBRIDGE_MEDIUM" onclick="addTaskSafe('DIARY:LUMBRIDGE_MEDIUM')">Lumbridge Medium</li>
<li id="DIARY:KARAMJA_EASY" onclick="addTaskSafe('DIARY:KARAMJA_EASY')">Karamja Easy</li>
<li id="DIARY:KOUREND_EASY" onclick="addTaskSafe('DIARY:KOUREND_EASY')">Kourend Easy</li>
        </ul>
 <!-- ===== MINIGAMES ===== -->
        <h2 onclick="toggleSection('minigames')">Minigames <span class="arrow">▶</span></h2>
        <ul id="minigames">
            <li id="MINIGAME:VALE_TOTEMS:TARGETLVL" onclick="addTaskSafe('MINIGAME:VALE_TOTEMS:TARGETLVL')">Vale Totems</li>
<li id="MINIGAME:MTA" onclick="addTaskSafe('MINIGAME:MTA')">Mage Training Arena</li>
<li id="MINIGAME:MTA:GREENLOG" onclick="addTaskSafe('MINIGAME:MTA:GREENLOG')">Mage Training Arena Greenlog</li>
<li id="MINIGAME:MTA:EFFICIENT" onclick="addTaskSafe('MINIGAME:MTA:EFFICIENT')">Mage Training Arena Efficient</li>
<li id="MINIGAME:MTA:ROBES" onclick="addTaskSafe('MINIGAME:MTA:ROBES')">Mage Training Arena Robes</li>
<li id="MINIGAME:MTA:B2P" onclick="addTaskSafe('MINIGAME:MTA:B2P')">Mage Training Arena B2P</li>
<li id="MINIGAME:MTA:WAND" onclick="addTaskSafe('MINIGAME:MTA:WAND')">Mage Training Arena Wand</li>
<li id="MINIGAME:MTA:BOOK" onclick="addTaskSafe('MINIGAME:MTA:BOOK')">Mage Training Arena Book</li>
<li id="MINIGAME:MTA:TOP" onclick="addTaskSafe('MINIGAME:MTA:TOP')">Mage Training Arena Top</li>
<li id="MINIGAME:MTA:BOTTOM" onclick="addTaskSafe('MINIGAME:MTA:BOTTOM')">Mage Training Arena Bottom</li>
<li id="MINIGAME:MTA:HAT" onclick="addTaskSafe('MINIGAME:MTA:HAT')">Mage Training Arena Hat</li>
<li id="MINIGAME:MTA:BOOTS" onclick="addTaskSafe('MINIGAME:MTA:BOOTS')">Mage Training Arena Boots</li>
<li id="MINIGAME:MTA:GLOVES" onclick="addTaskSafe('MINIGAME:MTA:GLOVES')">Mage Training Arena Gloves</li>
<li id="MINIGAME:MTA:POUCH" onclick="addTaskSafe('MINIGAME:MTA:POUCH')">Mage Training Arena Pouch</li>
<li id="MINIGAME:WINTERTODT:TARGETLVL" onclick="addTaskSafe('MINIGAME:WINTERTODT:TARGETLVL')">Wintertodt</li>
<li id="MINIGAME:MLM:TARGETLVL" onclick="addTaskSafe('MINIGAME:MLM:TARGETLVL')">Motherlode Mine</li>
<li id="MINIGAME:GF:TARGETLVL" onclick="addTaskSafe('MINIGAME:GF:TARGETLVL')">Giant's Foundry</li>
        </ul>
<!-- ===== IRONMAN STARTER ===== -->
        <h2 onclick="toggleSection('ironstarter')">Ironman Starter <span class="arrow">▶</span></h2>
        <ul id="ironstarter">
    <li id="IRON_STARTER_PART1" onclick="addTaskSafe('IRON_STARTER_PART1')">Ironman Starter Part 1</li>
    </ul>
</div>
    
<!-- RIGHT PANEL -->
<div id="right-panel">
    <h2>Selected Tasks</h2>
    <div id="stacked-tasks"></div>
    <button onclick="copyAll()">Copy Full Stack</button>
    <button onclick="resetStack()" class="secondary">Reset Stack</button>
</div>
<script>
/* ===== TOGGLE ===== */
function toggleSection(id) {
    const el = document.getElementById(id);
    const arrow = el.previousElementSibling.querySelector('.arrow');
    if (!el.style.display || el.style.display === 'none') {
        el.style.display = 'block';
        if(arrow) arrow.style.transform = 'rotate(90deg)';
    } else {
        el.style.display = 'none';
        if(arrow) arrow.style.transform = 'rotate(0deg)';
    }
}
}
/* ===== STACK ===== */
function addTaskSafe(task) {
    const div = document.createElement('div');
    div.className = 'stacked-task';
    div.textContent = task;
    document.getElementById('stacked-tasks').appendChild(div);
}
function copyAll() {
    const text = [...document.querySelectorAll('.stacked-task')].map(d => d.textContent).join('\n');
    navigator.clipboard.writeText(text);
    alert('Copied!');
}
function resetStack() { document.getElementById('stacked-tasks').innerHTML = ''; }
/* ===== SKILLS ===== */
const ALL_SKILLS = ["attack","strength","defence","ranged","prayer","magic","hitpoints",
"cooking","woodcutting","fletching","fishing","firemaking","crafting",
"smithing","mining","herblore","agility","thieving","slayer","farming",
"runecrafting","hunter","construction","sailing"];
let wikiSkills = {};
let skillClicks = {};
function renderSkillsGrid() {
    const grid = document.getElementById("skills-grid");
    grid.innerHTML = "";
    ALL_SKILLS.forEach(skill => {
        let wikiKey = skill === 'runecrafting' ? 'runecraft' : skill;
        const baseLevel = wikiSkills[wikiKey] || 1;
        skillClicks[skill] = baseLevel;
        const tile = document.createElement("div");
        tile.className = "skill-tile";
        tile.style.borderColor = baseLevel > 1 ? "#22c55e" : "#f87171";
        tile.onclick = () => {
            skillClicks[skill]++;
            addTaskSafe(`SKILL:${skill.toUpperCase()}:${skillClicks[skill]}`);
            tile.querySelector('.tooltip').textContent = `Current: ${baseLevel} → Target: ${skillClicks[skill]}`;
            tile.querySelector('.skill-level').textContent = `Lvl ${skillClicks[skill]}`;
        };
        tile.innerHTML = `
            <img src="icons/skills/${skill}.png">
            <div class="skill-name">${skill.toUpperCase()}</div>
            <div class="skill-level">Lvl ${baseLevel}</div>
            <div class="tooltip">Current: ${baseLevel} → Target: ${skillClicks[skill]}</div>
        `;
        grid.appendChild(tile);
    });
}

const QUEST_UI_TO_WIKI = {
    // Mage Arena
    "ma1": "mage arena",
    "ma2": "mage arena ii",

    // Fairy Tale
    "fairytale_i": "fairytale i - growing pains",

    // Romeo
    "romeo_and_juliet": "romeo & juliet",

    // Alfred
    "barcrawl": "alfred grimhand's barcrawl",

    // RFD subquests
    "rfd_cook": "another cook's quest",
    "rfd_dwarf": "freeing the mountain dwarf",
    "rfd_goblins": "freeing the goblin generals",
    "rfd_ogre": "freeing skrach uglogwee",
    "rfd_evil_dave": "freeing evil dave",
    "rfd_pirate": "freeing pirate pete",
    "rfd_guide": "freeing the lumbridge guide",
    "rfd_monkey": "freeing king awowogei",
    "rfd_amik_varze": "freeing sir amik varze",
    "rfd_culinaromancer": "defeating the culinaromancer"
};

const DIARY_EXCEPTIONS = {};

/* ===== NORMALIZE NAME ===== */
function normalizeName(name) {
    return name.toLowerCase()
        .replace(/&/g, 'and')             // convert & → and
        .replace(/[^\w\s]/g, '')          // remove other punctuation
        .replace(/\s+/g, '_')             // spaces → _
        .replace(/_i$/, '_1')             // roman numerals
        .replace(/_ii$/, '_2')
        .replace(/_iii$/, '_3')
        .replace(/_part_\d+$/, '')        // strip trailing part numbers
        .replace(/_+growing_pains$/, '')   // strip Fairy Tale growing pains from WikiSync
        .replace(/fairy_tale/, 'fairytale')   // fix Fairy Tale I normalization
        .trim();
}

function updateQuestsAndDiaries(data) {
    // === QUESTS ===
    if (data.quests) {
        document.querySelectorAll('#quests li').forEach(el => {
            let htmlNorm = normalizeName(el.textContent);
            let matchedKey = Object.keys(data.quests).find(k => {
                let wikiNorm = normalizeName(k);
                // Special handling for RFD quests: match prefix
                if (htmlNorm.startsWith('rfd') && wikiNorm.startsWith('recipe_for_disaster')) {
                    return true;
                }
                return htmlNorm === wikiNorm;
            });
            if (matchedKey) {
                el.className = data.quests[matchedKey] ? 'completed' : 'incomplete';
            } else {
                el.className = ''; // leave white if not found
            }
        });
    }

    // === DIARIES ===
    if (data.diaries) {
        document.querySelectorAll('#diaries li').forEach(el => {
            const htmlNorm = normalizeName(el.textContent);
            const matchedKey = Object.keys(data.diaries).find(k => normalizeName(k) === htmlNorm);
            if (matchedKey) {
                el.className = data.diaries[matchedKey] ? 'completed' : 'incomplete';
            } else {
                el.className = ''; // leave white if not found
            }
        });
    }
}



/* ===== WIKISYNC ===== */
async function importWikiSync() {
    const username = document.getElementById('wiki-username').value.trim();
    if (!username) return alert('Enter WikiSync username');
    try {
        const res = await fetch(`https://sync.runescape.wiki/runelite/player/${encodeURIComponent(username)}/STANDARD`);
        if (!res.ok) throw new Error("Fetch failed");
        const data = await res.json();
        wikiSkills = {};
        if (data.levels && typeof data.levels === 'object') {
            Object.entries(data.levels).forEach(([key,value]) => wikiSkills[key.toLowerCase()] = value);
        } else if (data.skills && typeof data.skills === 'object') {
            Object.entries(data.skills).forEach(([key,value]) => wikiSkills[key.toLowerCase()] = value);
        }
        renderSkillsGrid();
        updateQuestsAndDiaries(data);
        document.querySelectorAll('ul').forEach(ul => {
            ul.style.display = 'block';
            const arrow = ul.previousElementSibling.querySelector('.arrow');
            if (arrow) arrow.style.transform = 'rotate(90deg)';
        });
        alert('WikiSync applied: skills, quests, diaries updated.');
    } catch(err) {
        console.error(err);
        alert('Failed to fetch WikiSync data.');
    }
}
renderSkillsGrid();
</script>
</body>
</html>





