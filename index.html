<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P-Account Builder Helper</title>
<style>
body {
    font-family: "Trebuchet MS", sans-serif;
    background: #0f172a;
    color: #e2e8f0;
    margin: 0;
    display: flex;
    height: 100vh;
    overflow: hidden;
}
#left-panel {
    width: 380px;
    background: #1e293b;
    border-right: 2px solid #3b82f6;
    display: flex;
    flex-direction: column;
}
#left-panel input, #left-panel button {
    margin: 6px 10px;
}
#search, #wiki-username {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #3b82f6;
    background: #0f172a;
    color: #e2e8f0;
    width: calc(100% - 32px);
}
.scroll-container {
    overflow-y: auto;
    flex-grow: 1;
    padding: 10px;
}
h2 {
    color: #3b82f6;
    margin: 0;
    padding: 10px 5px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    background: #1e293b;
    position: sticky;
    top: 0;
    border-bottom: 1px solid #3b82f6;
}
.arrow { transition: transform 0.2s; }
ul {
    list-style: none;
    padding-left: 10px;
    margin: 0 0 15px 0;
    display: none;
}
li {
    padding: 5px 0;
    cursor: pointer;
}
li:hover { color: #3b82f6; }
li.completed {
    color: #22c55e;
    text-decoration: line-through;
}
li.incomplete {
    color: #ef4444;
}
.stacked-task {
    background: #1e293b;
    margin-bottom: 5px;
    padding: 5px;
    border-radius: 5px;
    font-family: monospace;
}
input[type=number] {
    width: 60px;
    padding: 3px;
    margin-left: 5px;
    border-radius: 4px;
    border: 1px solid #3b82f6;
    background: #0f172a;
    color: #e2e8f0;
}
#right-panel {
    flex-grow: 1;
    padding: 15px;
    overflow-y: auto;
}
button {
    padding: 8px;
    border-radius: 5px;
    border: none;
    background: #3b82f6;
    color: #fff;
    cursor: pointer;
    margin: 3px 0;
}
button.secondary {
    background: #475569;
}
button.debug {
    background: #facc15;
    color: #000;
    margin-left: 5px;
}
#stacked-tasks {
    max-height: 400px;
    overflow-y: auto;
    margin-bottom: 10px;
    border: 1px solid #3b82f6;
    padding: 5px;
    border-radius: 5px;
    background: #1e293b;
}
/* === SKILLS GRID === */
.skills-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    padding: 8px;
}
.skill-tile {
    background: #0f172a;
    border: 1px solid #334155;
    border-radius: 6px;
    padding: 6px;
    text-align: center;
    cursor: pointer;
    transition: all 0.15s ease;
}
.skill-tile:hover {
    border-color: #3b82f6;
    background: #1e293b;
}
.skill-tile img {
    width: 32px;
    height: 32px;
}
.skill-name {
    font-size: 11px;
    margin-top: 4px;
    color: #cbd5f5;
}
.skill-level {
    font-size: 12px;
    margin-top: 2px;
    color: #94a3b8;
}
.skill-locked {
    opacity: 0.45;
    cursor: not-allowed;
}
.skill-locked:hover {
    border-color: #334155;
    background: #0f172a;
}
</style>
</head>
<body>
<div id="left-panel">
    <input type="text" id="wiki-username" placeholder="RuneLite WikiSync Username">
    <button onclick="importWikiSync()" class="secondary">Import WikiSync</button>
    <input type="text" id="search" placeholder="Search tasks..." oninput="filterTasks()">
    <div class="scroll-container">

        <!-- Quests -->
        <h2 onclick="toggleSection('quests')">Quests <span class="arrow">▶</span></h2>
        <ul id="quests">
            <!-- FULL QUEST LIST (copied from your previous HTML) -->
            <li onclick="addTaskSafe('QUEST:COOKS_ASSISTANT')">Cooks Assistant</li>
            <li onclick="addTaskSafe('QUEST:DORICS_QUEST')">Doric's Quest</li>
            <li onclick="addTaskSafe('QUEST:DRUIDIC_RITUAL')">Druidic Ritual</li>
            <li onclick="addTaskSafe('QUEST:IMP_CATCHER')">Imp Catcher</li>
            <li onclick="addTaskSafe('QUEST:DWARF_CANNON')">Dwarf Cannon</li>
            <li onclick="addTaskSafe('QUEST:NATURAL_HISTORY_QUIZ')">Natural History Quiz</li>
            <li onclick="addTaskSafe('QUEST:ROMEO_AND_JULIET')">Romeo and Juliet</li>
            <li onclick="addTaskSafe('QUEST:SEA_SLUG')">Sea Slug</li>
            <li onclick="addTaskSafe('QUEST:SHEEP_SHEARER')">Sheep Shearer</li>
            <li onclick="addTaskSafe('QUEST:THE_FEUD')">The Feud</li>
            <li onclick="addTaskSafe('QUEST:WITCHS_HOUSE')">Witch's House</li>
            <li onclick="addTaskSafe('QUEST:WITCHS_POTION')">Witch's Potion</li>
            <li onclick="addTaskSafe('QUEST:BLACK_KNIGHTS_FORTRESS')">Black Knights' Fortress</li>
            <li onclick="addTaskSafe('QUEST:GERTRUDES_CAT')">Gertrude's Cat</li>
            <li onclick="addTaskSafe('QUEST:HORROR_FROM_THE_DEEP')">Horror from the Deep</li>
            <li onclick="addTaskSafe('QUEST:ELEMENTAL_WORKSHOP_I')">Elemental Workshop I</li>
            <li onclick="addTaskSafe('QUEST:DEATH_PLATEAU')">Death Plateau</li>
            <li onclick="addTaskSafe('QUEST:TROLL_STRONGHOLD')">Troll Stronghold</li>
            <li onclick="addTaskSafe('QUEST:X_MARKS_THE_SPOT')">X Marks the Spot</li>
            <li onclick="addTaskSafe('QUEST:BARCRAWL')">Alfred Grimhands Barcrawl</li>
            <li onclick="addTaskSafe('QUEST:CLIENT_OF_KOUREND')">Client of Kourend</li>
            <li onclick="addTaskSafe('QUEST:THE_RESTLESS_GHOST')">The Restless Ghost</li>
            <li onclick="addTaskSafe('QUEST:RUNE_MYSTERIES')">Rune Mysteries</li>
            <li onclick="addTaskSafe('QUEST:VAMPYRE_SLAYER')">Vampyre Slayer</li>
            <li onclick="addTaskSafe('QUEST:WATERFALL_QUEST')">Waterfall Quest</li>
            <li onclick="addTaskSafe('QUEST:PLAGUE_CITY')">Plague City</li>
            <li onclick="addTaskSafe('QUEST:BIOHAZARD')">Biohazard</li>
            <li onclick="addTaskSafe('QUEST:THE_KNIGHTS_SWORD')">The Knight's Sword</li>
            <li onclick="addTaskSafe('QUEST:ERNEST_THE_CHICKEN')">Ernest the Chicken</li>
            <li onclick="addTaskSafe('QUEST:MONKS_FRIEND')">Monk's Friend</li>
            <li onclick="addTaskSafe('QUEST:FIGHT_ARENA')">Fight Arena</li>
            <li onclick="addTaskSafe('QUEST:TREE_GNOME_VILLAGE')">Tree Gnome Village</li>
            <li onclick="addTaskSafe('QUEST:PRIEST_IN_PERIL')">Priest in Peril</li>
            <li onclick="addTaskSafe('QUEST:NATURE_SPIRIT')">Nature Spirit</li>
            <li onclick="addTaskSafe('QUEST:RFD_COOK')">RFD Cook</li>
            <li onclick="addTaskSafe('QUEST:RFD_DWARF')">RFD Dwarf</li>
            <li onclick="addTaskSafe('QUEST:FISHING_CONTEST')">Fishing Contest</li>
            <li onclick="addTaskSafe('QUEST:A_PORCINE_OF_INTEREST')">A Porcine of Interest</li>
            <li onclick="addTaskSafe('QUEST:ANIMAL_MAGNETISM')">Animal Magnetism</li>
            <li onclick="addTaskSafe('QUEST:MERLINS_CRYSTAL')">Merlin's Crystal</li>
            <li onclick="addTaskSafe('QUEST:HOLY_GRAIL')">Holy Grail</li>
            <li onclick="addTaskSafe('QUEST:DRAGON_SLAYER_I')">Dragon Slayer I</li>
            <li onclick="addTaskSafe('QUEST:LOST_CITY')">Lost City</li>
            <li onclick="addTaskSafe('QUEST:WHAT_LIES_BELOW')">What Lies Below</li>
            <li onclick="addTaskSafe('QUEST:THE_DIG_SITE')">The Dig Site</li>
            <li onclick="addTaskSafe('QUEST:THE_GRAND_TREE')">The Grand Tree</li>
            <li onclick="addTaskSafe('QUEST:GOBLIN_DIPLOMACY')">Goblin Diplomacy</li>
            <li onclick="addTaskSafe('QUEST:RFD_GOBLINS')">RFD Goblins</li>
            <li onclick="addTaskSafe('QUEST:FAIRYTALE_I')">Fairy Tale I</li>
            <li onclick="addTaskSafe('QUEST:BONE_VOYAGE')">Bone Voyage</li>
            <li onclick="addTaskSafe('QUEST:JUNGLE_POTION')">Jungle Potion</li>
            <li onclick="addTaskSafe('QUEST:THE_ASCENT_OF_ARCEUUS')">The Ascent of Arceuus</li>
            <li onclick="addTaskSafe('QUEST:SHILO_VILLAGE')">Shilo Village</li>
            <li onclick="addTaskSafe('QUEST:ONE_SMALL_FAVOUR')">One Small Favour</li>
            <li onclick="addTaskSafe('QUEST:MURDER_MYSTERY')">Murder Mystery</li>
            <li onclick="addTaskSafe('QUEST:KINGS_RANSOM')">King's Ransom</li>
            <li onclick="addTaskSafe('QUEST:THE_TOURIST_TRAP')">The Tourist Trap</li>
            <li onclick="addTaskSafe('QUEST:TEMPLE_OF_IKOV')">Temple of Ikov</li>
            <li onclick="addTaskSafe('QUEST:DESERT_TREASURE_I')">Desert Treasure I</li>
            <li onclick="addTaskSafe('QUEST:THE_FREMENNIK_TRIALS')">The Fremennik Trials</li>
            <li onclick="addTaskSafe('QUEST:OBSERVATORY_QUEST')">Observatory Quest</li>
            <li onclick="addTaskSafe('QUEST:DEMON_SLAYER')">Demon Slayer</li>
            <li onclick="addTaskSafe('QUEST:UNDERGROUND_PASS')">Underground Pass</li>
            <li onclick="addTaskSafe('QUEST:THE_GOLEM')">The Golem</li>
            <li onclick="addTaskSafe('QUEST:SHADOW_OF_THE_STORM')">Shadow of the Storm</li>
            <li onclick="addTaskSafe('QUEST:GHOSTS_AHOY')">Ghosts Ahoy</li>
            <li onclick="addTaskSafe('QUEST:MAKING_HISTORY')">Making History</li>
            <li onclick="addTaskSafe('QUEST:MOUNTAIN_DAUGHTER')">Mountain Daughter</li>
            <li onclick="addTaskSafe('QUEST:HAZEEL_CULT')">Hazeel Cult</li>
            <li onclick="addTaskSafe('QUEST:CHILDREN_OF_THE_SUN')">Children of the Sun</li>
            <li onclick="addTaskSafe('QUEST:PRINCE_ALI_RESCUE')">Prince Ali Rescue</li>
            <li onclick="addTaskSafe('QUEST:ICTHLARINS_LITTLE_HELPER')">Icthlarin's Little Helper</li>
            <li onclick="addTaskSafe('QUEST:ENTER_THE_ABYSS')">Enter the Abyss</li>
            <li onclick="addTaskSafe('QUEST:TEMPLE_OF_THE_EYE')">Temple of the Eye</li>
            <li onclick="addTaskSafe('QUEST:CREATURE_OF_FENKENSTRAIN')">Creature of Fenkenstrain</li>
            <li onclick="addTaskSafe('QUEST:THE_DEPTHS_OF_DESPAIR')">The Depths of Despair</li>
            <li onclick="addTaskSafe('QUEST:THE_QUEEN_OF_THIEVES')">The Queen of Thieves</li>
            <li onclick="addTaskSafe('QUEST:ENLIGHTENED_JOURNEY')">Enlightened Journey</li>
            <li onclick="addTaskSafe('QUEST:SHEEP_HERDER')">Sheep Herder</li>
            <li onclick="addTaskSafe('QUEST:BIG_CHOMPY_BIRD_HUNTING')">Big Chompy Bird Hunting</li>
            <li onclick="addTaskSafe('QUEST:RFD_OGRE')">RFD Ogre</li>
            <li onclick="addTaskSafe('QUEST:RFD_EVIL_DAVE')">RFD Evil Dave</li>
            <li onclick="addTaskSafe('QUEST:RFD_PIRATE')">RFD Pirate</li>
            <li onclick="addTaskSafe('QUEST:RFD_GUIDE')">RFD Lumbridge Guide</li>
            <li onclick="addTaskSafe('QUEST:RFD_MONKEY')">RFD Monkey</li>
            <li onclick="addTaskSafe('QUEST:RFD_AMIK_VARZE')">RFD Sir Amik Varze</li>
            <li onclick="addTaskSafe('QUEST:RFD_CULINAROMANCER')">RFD Culinaromancer</li>
            <li onclick="addTaskSafe('QUEST:SHIELD_OF_ARRAV')">Shield of Arrav</li>
            <li onclick="addTaskSafe('QUEST:HEROES_QUEST')">Heroes Quest</li>
            <li onclick="addTaskSafe('QUEST:TOWER_OF_LIFE')">Tower of Life</li>
            <li onclick="addTaskSafe('QUEST:CLOCK_TOWER')">Clock Tower</li>
            <li onclick="addTaskSafe('QUEST:TRIBAL_TOTEM')">Tribal Totem</li>
            <li onclick="addTaskSafe('QUEST:WATCHTOWER')">Watchtower</li>
            <li onclick="addTaskSafe('QUEST:GETTING_AHEAD')">Getting Ahead</li>
            <li onclick="addTaskSafe('QUEST:PIRATES_TREASURE')">Pirate's Treasure</li>
            <li onclick="addTaskSafe('QUEST:SCORPION_CATCHER')">Scorpion Catcher</li>
            <li onclick="addTaskSafe('QUEST:THE_CORSAIR_CURSE')">The Corsair Curse</li>
            <li onclick="addTaskSafe('QUEST:FAMILY_CREST')">Family Crest</li>
            <li onclick="addTaskSafe('QUEST:THE_GARDEN_OF_DEATH')">The Garden of Death</li>
            <li onclick="addTaskSafe('QUEST:MONKEY_MADNESS_I')">Monkey Madness I</li>
            <li onclick="addTaskSafe('QUEST:THE_FORSAKEN_TOWER')">The Forsaken Tower</li>
            <li onclick="addTaskSafe('QUEST:HAUNTED_MINE')">Haunted Mine</li>
            <li onclick="addTaskSafe('QUEST:TALE_OF_THE_RIGHTEOUS')">Tale of the Righteous</li>
            <li onclick="addTaskSafe('QUEST:SLEEPING_GIANTS')">Sleeping Giants</li>
            <li onclick="addTaskSafe('QUEST:TROLL_ROMANCE')">Troll Romance</li>
            <li onclick="addTaskSafe('QUEST:THE_LOST_TRIBE')">The Lost Tribe</li>
            <li onclick="addTaskSafe('QUEST:RECRUITMENT_DRIVE')">Recruitment Drive</li>
            <li onclick="addTaskSafe('QUEST:A_KINGDOM_DIVIDED')">A Kingdom Divided</li>
            <li onclick="addTaskSafe('QUEST:DEATH_ON_THE_ISLE')">Death on the Isle</li>
            <li onclick="addTaskSafe('QUEST:WANTED')">Wanted!</li>
            <li onclick="addTaskSafe('QUEST:TWILIGHTS_PROMISE')">Twilight's Promise</li>
            <li onclick="addTaskSafe('QUEST:REGICIDE')">Regicide</li>
            <li onclick="addTaskSafe('QUEST:RISE_OF_THE_RED_AXE')">Rise of the Red Axe</li>
            <li onclick="addTaskSafe('QUEST:THE_DEPTHS_OF_DESPAIR')">The Depths of Despair</li>
            <li onclick="addTaskSafe('QUEST:LEGENDS_QUEST')">Legends Quest</li>
            <li onclick="addTaskSafe('QUEST:MONKEY_MADNESS_II')">Monkey Madness II</li>
            <!-- Add all other quests similarly -->
        </ul>

        <!-- Skills Section -->
        <h2 onclick="toggleSection('skills')">Skills <span class="arrow">▶</span></h2>
        <ul id="skills">
            <div class="skills-grid" id="skills-grid"></div>
        </ul>

        <!-- Achievement Diaries -->
        <h2 onclick="toggleSection('diaries')">Achievement Diaries <span class="arrow">▶</span></h2>
        <ul id="diaries">
            <li onclick="addTaskSafe('DIARY:VARROCK_EASY')">Varrock Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:VARROCK_MEDIUM')">Varrock Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:VARROCK_HARD')">Varrock Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:VARROCK_ELITE')">Varrock Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:ARDOUGNE_EASY')">Ardougne Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:ARDOUGNE_MEDIUM')">Ardougne Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:ARDOUGNE_HARD')">Ardougne Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:ARDOUGNE_ELITE')">Ardougne Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:FALADOR_EASY')">Falador Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:FALADOR_MEDIUM')">Falador Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:FALADOR_HARD')">Falador Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:FALADOR_ELITE')">Falador Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:MORYTANIA_EASY')">Morytania Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:MORYTANIA_MEDIUM')">Morytania Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:MORYTANIA_HARD')">Morytania Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:MORYTANIA_ELITE')">Morytania Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:KANDARIN_EASY')">Kandarin Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:KANDARIN_MEDIUM')">Kandarin Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:KANDARIN_HARD')">Kandarin Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:KANDARIN_ELITE')">Kandarin Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:DESERT_EASY')">Desert Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:DESERT_MEDIUM')">Desert Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:DESERT_HARD')">Desert Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:DESERT_ELITE')">Desert Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:FREMENNIK_EASY')">Fremennik Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:FREMENNIK_MEDIUM')">Fremennik Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:FREMENNIK_HARD')">Fremennik Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:FREMENNIK_ELITE')">Fremennik Diary (Elite)</li>
            <li onclick="addTaskSafe('DIARY:WILDERNESS_EASY')">Wilderness Diary (Easy)</li>
            <li onclick="addTaskSafe('DIARY:WILDERNESS_MEDIUM')">Wilderness Diary (Medium)</li>
            <li onclick="addTaskSafe('DIARY:WILDERNESS_HARD')">Wilderness Diary (Hard)</li>
            <li onclick="addTaskSafe('DIARY:WILDERNESS_ELITE')">Wilderness Diary (Elite)</li>
        </ul>

        <!-- Add other sections: Minigames, Milestones, Iron Starter etc. similarly -->

    </div>
</div>

<div id="right-panel">
    <h2>Selected Tasks</h2>
    <div id="stacked-tasks"></div>
</div>

<script>
let stackedTasks = [];
let wikiSkills = {};
let wikiQuests = {};

function addTaskSafe(task){
    if(!stackedTasks.includes(task)){
        stackedTasks.push(task);
        renderStackedTasks();
    }
}

function renderStackedTasks(){
    const container = document.getElementById('stacked-tasks');
    container.innerHTML = '';
    stackedTasks.forEach(t => {
        const div = document.createElement('div');
        div.className = 'stacked-task';
        div.textContent = t;
        container.appendChild(div);
    });
}

function toggleSection(id){
    const ul = document.getElementById(id);
    ul.style.display = ul.style.display==='block'?'none':'block';
    const arrow = ul.previousElementSibling.querySelector('.arrow');
    arrow.style.transform = ul.style.display==='block'?'rotate(90deg)':'rotate(0deg)';
}

function filterTasks(){
    const filter = document.getElementById('search').value.toLowerCase();
    document.querySelectorAll('ul li').forEach(li=>{
        li.style.display = li.textContent.toLowerCase().includes(filter)?'block':'none';
    });
}

// === SKILLS SETUP ===
const allSkills = ["Attack","Strength","Defence","Hitpoints","Ranged","Prayer","Magic","Cooking","Woodcutting","Fletching","Fishing","Firemaking","Crafting","Smithing","Mining","Herblore","Agility","Thieving","Slayer","Farming","Runecrafting","Hunter","Construction","Sailing"];

function getSkillLevel(skill){
    const key = skill.toLowerCase();
    return wikiSkills[key] || 1;
}

function setupSkillsGrid(){
    const grid = document.getElementById('skills-grid');
    grid.innerHTML = '';
    allSkills.forEach(skill=>{
        const level = getSkillLevel(skill);
        const tile = document.createElement('div');
        tile.className = 'skill-tile';
        tile.innerHTML = `<div class="skill-name">${skill}</div><div class="skill-level" id="level-${skill}">${level}</div>`;
        tile.onclick = ()=>{
            wikiSkills[skill.toLowerCase()] = (wikiSkills[skill.toLowerCase()] || level) + 1;
            document.getElementById(`level-${skill}`).textContent = wikiSkills[skill.toLowerCase()];
        };
        grid.appendChild(tile);
    });
}

setupSkillsGrid();

// === WIKISYNC IMPORT ===
function importWikiSync(){
    const username = document.getElementById('wiki-username').value.trim();
    if(!username) return alert('Enter WikiSync username');
    fetch(`https://runelite.net/api/wikisync/${username}`)
    .then(res=>res.json())
    .then(data=>{
        wikiSkills = {};
        wikiQuests = {};
        if(data.skills){
            Object.keys(data.skills).forEach(k=>{
                wikiSkills[k.toLowerCase()] = data.skills[k];
            });
        }
        if(data.quests){
            wikiQuests = data.quests;
            updateQuestColors();
        }
        setupSkillsGrid();
    }).catch(err=>{console.error(err); alert('Failed to fetch WikiSync');});
}

function normalizeQuestName(name){
    return name.replace(/['&]/g,'').replace(/\s+/g,'_').toUpperCase();
}

function updateQuestColors(){
    if(!wikiQuests) return;
    document.querySelectorAll("#quests li").forEach(li=>{
        const norm = normalizeQuestName(li.textContent);
        const found = Object.keys(wikiQuests).find(q=>normalizeQuestName(q)===norm);
        if(found) li.className = wikiQuests[found]===2?'completed':'incomplete';
    });
}
</script>
</body>
</html>


#
#
#
#
#
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>P-Account Builder Helper</title>
<style>
body {
    font-family: "Trebuchet MS", sans-serif;
    background: #0f172a;
    color: #e2e8f0;
    margin: 0;
    display: flex;
    height: 100vh;
    overflow: hidden;
}
#left-panel {
    width: 380px;
    background: #1e293b;
    border-right: 2px solid #3b82f6;
    display: flex;
    flex-direction: column;
}
#left-panel input, #left-panel button {
    margin: 6px 10px;
}
#wiki-username, #search {
    padding: 6px;
    border-radius: 5px;
    border: 1px solid #3b82f6;
    background: #0f172a;
    color: #e2e8f0;
    width: calc(100% - 32px);
}
.scroll-container {
    overflow-y: auto;
    flex-grow: 1;
    padding: 10px;
}
h2 {
    color: #3b82f6;
    margin: 0;
    padding: 10px 5px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    background: #1e293b;
    position: sticky;
    top: 0;
    border-bottom: 1px solid #3b82f6;
}
.arrow { transition: transform 0.2s; }
ul { list-style: none; padding-left: 10px; margin: 0 0 15px 0; display: none; }
li { padding: 5px 0; cursor: pointer; }
li:hover { color: #3b82f6; }
li.completed { color: #22c55e; text-decoration: line-through; }
li.incomplete { color: #ef4444; }
.stacked-task {
    background: #1e293b;
    margin-bottom: 5px;
    padding: 5px;
    border-radius: 5px;
    font-family: monospace;
}
#right-panel {
    flex-grow: 1;
    padding: 15px;
    overflow-y: auto;
}
button {
    padding: 8px;
    border-radius: 5px;
    border: none;
    background: #3b82f6;
    color: #fff;
    cursor: pointer;
    margin: 3px 0;
}
button.secondary {
    background: #475569;
}
.skills-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
    padding: 8px;
}
.skill-tile {
    background: #0f172a;
    border: 1px solid #334155;
    border-radius: 6px;
    padding: 6px;
    text-align: center;
    cursor: pointer;
}
.skill-tile img {
    width: 32px;
    height: 32px;
}
.skill-name { font-size: 11px; margin-top: 4px; color: #cbd5f5; }
.skill-level { font-size: 12px; margin-top: 2px; color: #94a3b8; }
</style>
</head>
<body>
<div id="left-panel">
    <input type="text" id="wiki-username" placeholder="RuneLite WikiSync Username">
    <button onclick="importWikiSync()" class="secondary">Import WikiSync</button>
    <input type="text" id="search" placeholder="Search tasks..." oninput="filterTasks()">
    <div class="scroll-container">

        <!-- Quests -->
        <h2 onclick="toggleSection('quests')">Quests <span class="arrow">▶</span></h2>
        <ul id="quests">
            <!-- *** COPY/PASTE ALL QUESTS EXACTLY AS PROVIDED *** -->
            <li onclick="addTaskSafe('QUEST:COOKS_ASSISTANT')">Cooks Assistant</li>
            <li onclick="addTaskSafe('QUEST:DORICS_QUEST')">Doric's Quest</li>
            <li onclick="addTaskSafe('QUEST:DRUIDIC_RITUAL')">Druidic Ritual</li>
            <li onclick="addTaskSafe('QUEST:IMP_CATCHER')">Imp Catcher</li>
            <li onclick="addTaskSafe('QUEST:DWARF_CANNON')">Dwarf Cannon</li>
            <li onclick="addTaskSafe('QUEST:NATURAL_HISTORY_QUIZ')">Natural History Quiz</li>
            <li onclick="addTaskSafe('QUEST:ROMEO_AND_JULIET')">Romeo and Juliet</li>
            <li onclick="addTaskSafe('QUEST:SEA_SLUG')">Sea Slug</li>
            <li onclick="addTaskSafe('QUEST:SHEEP_SHEARER')">Sheep Shearer</li>
            <li onclick="addTaskSafe('QUEST:THE_FEUD')">The Feud</li>
            <li onclick="addTaskSafe('QUEST:WITCHS_HOUSE')">Witch's House</li>
            <li onclick="addTaskSafe('QUEST:WITCHS_POTION')">Witch's Potion</li>
            <li onclick="addTaskSafe('QUEST:BLACK_KNIGHTS_FORTRESS')">Black Knights' Fortress</li>
            <li onclick="addTaskSafe('QUEST:GERTRUDES_CAT')">Gertrude's Cat</li>
            <li onclick="addTaskSafe('QUEST:HORROR_FROM_THE_DEEP')">Horror from the Deep</li>
            <li onclick="addTaskSafe('QUEST:ELEMENTAL_WORKSHOP_I')">Elemental Workshop I</li>
            <li onclick="addTaskSafe('QUEST:DEATH_PLATEAU')">Death Plateau</li>
            <li onclick="addTaskSafe('QUEST:TROLL_STRONGHOLD')">Troll Stronghold</li>
            <li onclick="addTaskSafe('QUEST:X_MARKS_THE_SPOT')">X Marks the Spot</li>
            <li onclick="addTaskSafe('QUEST:BARCRAWL')">Alfred Grimhands Barcrawl</li>
            <li onclick="addTaskSafe('QUEST:CLIENT_OF_KOUREND')">Client of Kourend</li>
            <li onclick="addTaskSafe('QUEST:THE_RESTLESS_GHOST')">The Restless Ghost</li>
            <li onclick="addTaskSafe('QUEST:RUNE_MYSTERIES')">Rune Mysteries</li>
            <li onclick="addTaskSafe('QUEST:VAMPYRE_SLAYER')">Vampyre Slayer</li>
            <li onclick="addTaskSafe('QUEST:WATERFALL_QUEST')">Waterfall Quest</li>
            <li onclick="addTaskSafe('QUEST:PLAGUE_CITY')">Plague City</li>
            <li onclick="addTaskSafe('QUEST:BIOHAZARD')">Biohazard</li>
            <li onclick="addTaskSafe('QUEST:THE_KNIGHTS_SWORD')">The Knight's Sword</li>
            <li onclick="addTaskSafe('QUEST:ERNEST_THE_CHICKEN')">Ernest the Chicken</li>
            <li onclick="addTaskSafe('QUEST:MONKS_FRIEND')">Monk's Friend</li>
            <li onclick="addTaskSafe('QUEST:FIGHT_ARENA')">Fight Arena</li>
            <li onclick="addTaskSafe('QUEST:TREE_GNOME_VILLAGE')">Tree Gnome Village</li>
            <li onclick="addTaskSafe('QUEST:PRIEST_IN_PERIL')">Priest in Peril</li>
            <li onclick="addTaskSafe('QUEST:NATURE_SPIRIT')">Nature Spirit</li>
            <li onclick="addTaskSafe('QUEST:RFD_COOK')">RFD Cook</li>
            <li onclick="addTaskSafe('QUEST:RFD_DWARF')">RFD Dwarf</li>
            <li onclick="addTaskSafe('QUEST:FISHING_CONTEST')">Fishing Contest</li>
            <li onclick="addTaskSafe('QUEST:A_PORCINE_OF_INTEREST')">A Porcine of Interest</li>
            <li onclick="addTaskSafe('QUEST:ANIMAL_MAGNETISM')">Animal Magnetism</li>
            <li onclick="addTaskSafe('QUEST:MERLINS_CRYSTAL')">Merlins Crystal</li>
            <li onclick="addTaskSafe('QUEST:HOLY_GRAIL')">Holy Grail</li>
            <li onclick="addTaskSafe('QUEST:DRAGON_SLAYER_I')">Dragon Slayer I</li>
            <li onclick="addTaskSafe('QUEST:LOST_CITY')">Lost City</li>
            <li onclick="addTaskSafe('QUEST:WHAT_LIES_BELOW')">What Lies Below</li>
            <li onclick="addTaskSafe('QUEST:THE_DIG_SITE')">The Dig Site</li>
            <li onclick="addTaskSafe('QUEST:THE_GRAND_TREE')">The Grand Tree</li>
            <li onclick="addTaskSafe('QUEST:GOBLIN_DIPLOMACY')">Goblin Diplomacy</li>
            <li onclick="addTaskSafe('QUEST:RFD_GOBLINS')">RFD Goblins</li>
            <li onclick="addTaskSafe('QUEST:FAIRYTALE_I')">Fairy Tale I</li>
            <li onclick="addTaskSafe('QUEST:BONE_VOYAGE')">Bone Voyage</li>
            <li onclick="addTaskSafe('QUEST:JUNGLE_POTION')">Jungle Potion</li>
            <li onclick="addTaskSafe('QUEST:THE_ASCENT_OF_ARCEUUS')">The Ascent of Arceuus</li>
            <li onclick="addTaskSafe('QUEST:SHILO_VILLAGE')">Shilo Village</li>
            <li onclick="addTaskSafe('QUEST:ONE_SMALL_FAVOUR')">One Small Favour</li>
            <li onclick="addTaskSafe('QUEST:MURDER_MYSTERY')">Murder Mystery</li>
            <li onclick="addTaskSafe('QUEST:KINGS_RANSOM')">King's Ransom</li>
            <li onclick="addTaskSafe('QUEST:THE_TOURIST_TRAP')">The Tourist Trap</li>
            <li onclick="addTaskSafe('QUEST:TEMPLE_OF_IKOV')">Temple of Ikov</li>
            <li onclick="addTaskSafe('QUEST:DESERT_TREASURE_I')">Desert Treasure I</li>
            <li onclick="addTaskSafe('QUEST:THE_FREMENNIK_TRIALS')">The Fremennik Trials</li>
            <li onclick="addTaskSafe('QUEST:OBSERVATORY_QUEST')">Observatory Quest</li>
            <li onclick="addTaskSafe('QUEST:DEMON_SLAYER')">Demon Slayer</li>
            <li onclick="addTaskSafe('QUEST:UNDERGROUND_PASS')">Underground Pass</li>
            <li onclick="addTaskSafe('QUEST:THE_GOLEM')">The Golem</li>
            <li onclick="addTaskSafe('QUEST:SHADOW_OF_THE_STORM')">Shadow of the Storm</li>
            <li onclick="addTaskSafe('QUEST:GHOSTS_AHOY')">Ghosts Ahoy</li>
            <li onclick="addTaskSafe('QUEST:MAKING_HISTORY')">Making History</li>
            <li onclick="addTaskSafe('QUEST:MOUNTAIN_DAUGHTER')">Mountain Daughter</li>
            <li onclick="addTaskSafe('QUEST:HAZEEL_CULT')">Hazeel Cult</li>
            <li onclick="addTaskSafe('QUEST:CHILDREN_OF_THE_SUN')">Children of the Sun</li>
            <li onclick="addTaskSafe('QUEST:PRINCE_ALI_RESCUE')">Prince Ali Rescue</li>
            <li onclick="addTaskSafe('QUEST:ICTHLARINS_LITTLE_HELPER')">Icthlarin's Little Helper</li>
            <li onclick="addTaskSafe('QUEST:ENTER_THE_ABYSS')">Enter the Abyss</li>
            <li onclick="addTaskSafe('QUEST:TEMPLE_OF_THE_EYE')">Temple of the Eye</li>
            <li onclick="addTaskSafe('QUEST:CREATURE_OF_FENKENSTRAIN')">Creature of Fenkenstrain</li>
            <li onclick="addTaskSafe('QUEST:THE_DEPTHS_OF_DESPAIR')">The Depths of Despair</li>
            <li onclick="addTaskSafe('QUEST:THE_QUEEN_OF_THIEVES')">The Queen of Thieves</li>
            <li onclick="addTaskSafe('QUEST:ENLIGHTENED_JOURNEY')">Enlightened Journey</li>
            <li onclick="addTaskSafe('QUEST:SHEEP_HERDER')">Sheep Herder</li>
            <li onclick="addTaskSafe('QUEST:BIG_CHOMPY_BIRD_HUNTING')">Big Chompy Bird Hunting</li>
            <li onclick="addTaskSafe('QUEST:RFD_OGRE')">RFD Ogre</li>
            <li onclick="addTaskSafe('QUEST:RFD_EVIL_DAVE')">RFD Evil Dave</li>
            <li onclick="addTaskSafe('QUEST:RFD_PIRATE')">RFD Pirate</li>
            <li onclick="addTaskSafe('QUEST:RFD_GUIDE')">RFD Lumbridge Guide</li>
            <li onclick="addTaskSafe('QUEST:RFD_MONKEY')">RFD Monkey</li>
            <li onclick="addTaskSafe('QUEST:RFD_AMIK_VARZE')">RFD Sir Amik Varze</li>
            <li onclick="addTaskSafe('QUEST:RFD_CULINAROMANCER')">RFD Culinaromancer</li>
            <li onclick="addTaskSafe('QUEST:SHIELD_OF_ARRAV')">Shield of Arrav</li>
            <li onclick="addTaskSafe('QUEST:HEROES_QUEST')">Heroes Quest</li>
            <li onclick="addTaskSafe('QUEST:TOWER_OF_LIFE')">Tower of Life</li>
            <li onclick="addTaskSafe('QUEST:CLOCK_TOWER')">Clock Tower</li>
            <li onclick="addTaskSafe('QUEST:TRIBAL_TOTEM')">Tribal Totem</li>
            <li onclick="addTaskSafe('QUEST:WATCHTOWER')">Watchtower</li>
            <li onclick="addTaskSafe('QUEST:GETTING_AHEAD')">Getting Ahead</li>
            <li onclick="addTaskSafe('QUEST:PIRATES_TREASURE')">Pirate's Treasure</li>
            <li onclick="addTaskSafe('QUEST:SCORPION_CATCHER')">Scorpion Catcher</li>
            <li onclick="addTaskSafe('QUEST:THE_CORSAIR_CURSE')">The Corsair Curse</li>
            <li onclick="addTaskSafe('QUEST:FAMILY_CREST')">Family Crest</li>
            <li onclick="addTaskSafe('QUEST:THE_GARDEN_OF_DEATH')">The Garden of Death</li>
            <li onclick="addTaskSafe('QUEST:MONKEY_MADNESS_I')">Monkey Madness I</li>
            <li onclick="addTaskSafe('QUEST:THE_FORSAKEN_TOWER')">The Forsaken Tower</li>
            <li onclick="addTaskSafe('QUEST:HAUNTED_MINE')">Haunted Mine</li>
            <li onclick="addTaskSafe('QUEST:TALE_OF_THE_RIGHTEOUS')">Tale of the Righteous</li>
            <li onclick="addTaskSafe('QUEST:SLEEPING_GIANTS')">Sleeping Giants</li>
            <li onclick="addTaskSafe('QUEST:TROLL_ROMANCE')">Troll Romance</li>
            <li onclick="addTaskSafe('QUEST:THE_LOST_TRIBE')">The Lost Tribe</li>
            <li onclick="addTaskSafe('QUEST:RECRUITMENT_DRIVE')">Recruitment Drive</li>
            <li onclick="addTaskSafe('QUEST:A_KINGDOM_DIVIDED')">A Kingdom Divided</li>
            <li onclick="addTaskSafe('QUEST:DEATH_ON_THE_ISLE')">Death on the Isle</li>
            <li onclick="addTaskSafe('QUEST:WANTED')">Wanted!</li>
            <li onclick="addTaskSafe('QUEST:TWILIGHTS_PROMISE')">Twilights Promise</li>
            <li onclick="addTaskSafe('QUEST:REGICIDE')">Regicide</li>
            <li onclick="addTaskSafe('QUEST:ROVING_ELVES')">Roving Elves</li>
            <li onclick="addTaskSafe('QUEST:MOURNINGS_END_PART_I')">Mourning's End Part I</li>
            <li onclick="addTaskSafe('QUEST:MOURNINGS_END_PART_II')">Mourning's End Part II</li>
            <li onclick="addTaskSafe('QUEST:ETHICALLY_ACQUIRED_ANTIQUITIES')">Ethically Acquired Antiquities</li>
            <li onclick="addTaskSafe('QUEST:DADDYS_HOME')">Daddy's Home</li>
            <li onclick="addTaskSafe('QUEST:LUNAR_DIPLOMACY')">Lunar Diplomacy</li>
            <li onclick="addTaskSafe('QUEST:IN_SEARCH_OF_THE_MYREQUE')">In Search of the Myreque</li>
            <li onclick="addTaskSafe('QUEST:IN_AID_OF_THE_MYREQUE')">In Aid of the Myreque</li>
            <li onclick="addTaskSafe('QUEST:THRONE_OF_MISCELLANIA')">Throne of Miscellania</li>
            <li onclick="addTaskSafe('QUEST:ROYAL_TROUBLE')">Royal Trouble</li>
            <li onclick="addTaskSafe('QUEST:THE_HAND_IN_THE_SAND')">The Hand in the Sand</li>
            <li onclick="addTaskSafe('QUEST:ZOGRE_FLESH_EATERS')">Zogre Flesh Eaters</li>
            <li onclick="addTaskSafe('QUEST:RUM_DEAL')">Rum Deal</li>
            <li onclick="addTaskSafe('QUEST:CABIN_FEVER')">Cabin Fever</li>
            <li onclick="addTaskSafe('QUEST:THE_EYES_OF_GLOUPHRIE')">The Eyes of Glouphrie</li>
            <li onclick="addTaskSafe('QUEST:THE_SLUG_MENACE')">The Slug Menace</li>
            <li onclick="addTaskSafe('QUEST:BELOW_ICE_MOUNTAIN')">Below Ice Mountain</li>
            <li onclick="addTaskSafe('QUEST:EADGARS_RUSE')">Eadgars Ruse</li>
            <li onclick="addTaskSafe('QUEST:GARDEN_OF_TRANQUILLITY')">Garden of Tranquillity</li>
            <li onclick="addTaskSafe('QUEST:A_SOULS_BANE')">A Soul's Bane</li>
            <li onclick="addTaskSafe('QUEST:SHADOWS_OF_CUSTODIA')">Shadows of Custodia</li>
            <li onclick="addTaskSafe('QUEST:MONKEY_MADNESS_II')">Monkey Madness II</li>
            <li onclick="addTaskSafe('QUEST:TAI_BWO_WANNAI_TRIO')">Tai Bwo Wannai Trio</li>
            <li onclick="addTaskSafe('QUEST:BARBARIAN_TRAINING')">Barbarian Training</li>
            <li onclick="addTaskSafe('QUEST:THE_FREMENNIK_ISLES')">The Fremennik Isles</li>
            <li onclick="addTaskSafe('QUEST:PANDEMONIUM')">Pandemonium</li>
            <li onclick="addTaskSafe('QUEST:PRYING_TIMES')">Prying Times</li>
            <li onclick="addTaskSafe('QUEST:CURRENT_AFFAIRS')">Current Affairs</li>
            <li onclick="addTaskSafe('QUEST:MA1')">Mage Arena I</li>
            <li onclick="addTaskSafe('QUEST:MA2')">Mage Arena II</li>
        </ul>

        <!-- Skills -->
        <h2 onclick="toggleSection('skills')">Skills <span class="arrow">▶</span></h2>
        <ul id="skills"><div class="skills-grid" id="skills-grid"></div></ul>

        <!-- Achievement Diaries -->
        <h2 onclick="toggleSection('diaries')">Achievement Diaries <span class="arrow">▶</span></h2>
        <ul id="diaries">
            <li onclick="addTaskSafe('DIARY:VARROCK_EASY')">Varrock Easy</li>
            <li onclick="addTaskSafe('DIARY:VARROCK_MEDIUM')">Varrock Medium</li>
            <li onclick="addTaskSafe('DIARY:ARDOUGNE_EASY')">Ardougne Easy</li>
            <li onclick="addTaskSafe('DIARY:ARDOUGNE_MEDIUM')">Ardougne Medium</li>
            <li onclick="addTaskSafe('DIARY:LUMBRIDGE_EASY')">Lumbridge Easy</li>
            <li onclick="addTaskSafe('DIARY:LUMBRIDGE_MEDIUM')">Lumbridge Medium</li>
            <li onclick="addTaskSafe('DIARY:KARAMJA_EASY')">Karamja Easy</li>
            <li onclick="addTaskSafe('DIARY:KOUREND_EASY')">Kourend Easy</li>
        </ul>

        <!-- Repeating -->
        <h2 onclick="toggleSection('repeating')">Repeating Tasks <span class="arrow">▶</span></h2>
        <ul id="repeating">
            <li onclick="addTaskSafe('REPEATING:BIRDHOUSES:HUNTERLVL')">Birdhouse Runs</li>
            <li onclick="addTaskSafe('REPEATING:TREE_RUNS:FARMINGLVL')">Tree Runs</li>
            <li onclick="addTaskSafe('REPEATING:HERB_RUNS:FARMINGLVL')">Herb Runs</li>
            <li onclick="addTaskSafe('REPEATING:SEAWEED_RUNS:FARMINGLVL')">Seaweed Runs</li>
            <li onclick="addTaskSafe('REPEATING:HOP_RUNS:FARMINGLVL')">Hop Runs</li>
            <li onclick="addTaskSafe('REPEATING:COMPOST_RUNS')">Compost Runs</li>
            <li onclick="addTaskSafe('REPEATING:HESPORI')">Hespori</li>
            <li onclick="addTaskSafe('REPEATING:KINGDOM:MAHOG:HERB')">Kingdom of Miscellania</li>
        </ul>

        <!-- Milestones -->
        <h2 onclick="toggleSection('milestones')">Milestones <span class="arrow">▶</span></h2>
        <ul id="milestones">
            <li onclick="addTaskSafe('MILESTONE:DRAGON_DEFENDER')">Dragon Defender</li>
            <li onclick="addTaskSafe('MILESTONE:RUNE_DEFENDER')">Rune Defender</li>
            <li onclick="addTaskSafe('MILESTONE:FAIRY_RINGS')">Fairy Rings</li>
            <li onclick="addTaskSafe('MILESTONE:UNLOCK_PIETY')">Piety / Knight Waves Training Grounds</li>
            <li onclick="addTaskSafe('MILESTONE:ROGUES_OUTFIT')">Rogues Outfit</li>
            <li onclick="addTaskSafe('MILESTONE:ROCK_CAKE')">Rock Cake</li>
            <li onclick="addTaskSafe('MILESTONE:BLACK_MASK')">Black Mask</li>
        </ul>

        <!-- Minigames -->
        <h2 onclick="toggleSection('minigames')">Minigames <span class="arrow">▶</span></h2>
        <ul id="minigames">
            <li onclick="addTaskSafe('MINIGAME:VALE_TOTEMS:TARGETLVL')">Vale Totems</li>
            <li onclick="addTaskSafe('MINIGAME:MTA')">Mage Training Arena</li>
            <li onclick="addTaskSafe('MINIGAME:WINTERTODT:TARGETLVL')">Wintertodt</li>
            <li onclick="addTaskSafe('MINIGAME:MLM:TARGETLVL')">Motherlode Mine</li>
            <li onclick="addTaskSafe('MINIGAME:GF:TARGETLVL')">Giant's Foundry</li>
        </ul>

        <!-- Ironman Starter -->
        <h2 onclick="toggleSection('ironstarter')">Ironman Starter <span class="arrow">▶</span></h2>
        <ul id="ironstarter">
            <li onclick="addTaskSafe('IRON_STARTER_PART1')">Ironman Starter Part 1</li>
        </ul>

    </div>
</div>

<div id="right-panel">
    <h2>Selected Tasks</h2>
    <div id="stacked-tasks"></div>
</div>

<script>
// == GLOBAL ==
let stackedTasks = [];
let wikiSkillData = {};
let wikiQuestData = {};

// == COMMON HELPERS ==
function addTaskSafe(task){
    stackedTasks.push(task);
    renderStack();
}
function renderStack(){
    const box = document.getElementById("stacked-tasks");
    box.innerHTML = "";
    stackedTasks.forEach(t=>{
        const div = document.createElement("div");
        div.className = "stacked-task";
        div.textContent = t;
        box.appendChild(div);
    });
}

function toggleSection(id){
    const el = document.getElementById(id);
    el.style.display = el.style.display==="block"?"none":"block";
    const arrow = el.previousElementSibling.querySelector(".arrow");
    arrow.style.transform = el.style.display==="block"?"rotate(90deg)":"rotate(0deg)";
}

function filterTasks(){
    const term = document.getElementById("search").value.toLowerCase();
    document.querySelectorAll("#quests li, #diaries li, #milestones li, #minigames li, #repeating li, #ironstarter li")
        .forEach(li => {
            li.style.display = li.textContent.toLowerCase().includes(term)?"block":"none";
        });
}

// == SKILLS ==
const ALL_SKILLS = ["attack","strength","defence","ranged","prayer","magic","hitpoints",
"cooking","woodcutting","fletching","fishing","firemaking","crafting","smithing","mining",
"herblore","agility","thieving","slayer","farming","runecrafting","hunter","construction","sailing"];

function getSkillLevel(skill){
    return wikiSkillData[skill.toLowerCase()]||1;
}

function renderSkills(){
    const grid = document.getElementById("skills-grid");
    grid.innerHTML = "";
    ALL_SKILLS.forEach(s=>{
        const lvl = getSkillLevel(s);
        const div = document.createElement("div");
        div.className = "skill-tile";
        div.innerHTML = `<img src="icons/skills/${s}.png"><div class="skill-name">${s.toUpperCase()}</div><div class="skill-level">${lvl}</div>`;
        div.onclick = ()=>{
            const newLvl = (wikiSkillData[s.toLowerCase()]||lvl)+1;
            wikiSkillData[s.toLowerCase()] = newLvl;
            div.querySelector(".skill-level").textContent = newLvl;
            addTaskSafe(`SKILL:${s.toUpperCase()}:${newLvl}`);
        };
        grid.appendChild(div);
    });
}

// == WIKISYNC ==
function normalizeQuest(q){
    return q.replace(/['&]/g,"").replace(/\s+/g,"_").toUpperCase();
}

async function importWikiSync(){
    const user = document.getElementById("wiki-username").value.trim();
    if(!user) return alert("Enter WikiSync username");
    try{
        const res = await fetch(`https://sync.runescape.wiki/runelite/player/${encodeURIComponent(user)}/STANDARD`);
        if(!res.ok) throw new Error("Bad response");
        const data = await res.json();
        wikiSkillData = data.levels||{};
        wikiQuestData = data.quests||{};
        renderSkills();

        // color quests
        document.querySelectorAll("#quests li").forEach(li=>{
            const name = normalizeQuest(li.textContent);
            if(wikiQuestData[name]===2) li.className="completed"; else li.className="incomplete";
        });

        // diaries do simple exist check
        document.querySelectorAll("#diaries li").forEach(li=>{
            const d = normalizeQuest(li.textContent);
            if(data.achievement_diaries && data.achievement_diaries[d]) li.className="completed";
        });

        alert("WikiSync applied!");
    }catch(e){
        console.error(e);
        alert("Failed to fetch WikiSync data");
    }
}

renderSkills();
</script>
</body>
</html>

